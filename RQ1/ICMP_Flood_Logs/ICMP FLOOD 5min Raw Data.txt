


defender:  sudo snort -A console -c /etc/snort/snort.conf -i eth0 -l ./Logs/icmpFlood/

response time: less than 1 seconds

05/15-18:24:20.560752  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560755  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560758  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560761  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560764  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560767  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560770  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560773  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560776  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560779  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560844  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560850  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560854  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560858  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560861  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560864  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560868  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560871  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560874  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560883  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560886  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560889  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560892  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560895  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560956  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560960  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560963  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560967  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560972  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560975  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560978  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.560982  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.566707  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.75 -> 192.168.178.81
05/15-18:24:20.566712  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.75 -> 192.168.178.81
05/15-18:24:20.566713  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.75 -> 192.168.178.81
05/15-18:24:20.566715  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.75 -> 192.168.178.81
05/15-18:24:20.566756  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.566780  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.566799  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
05/15-18:24:20.566816  [**] [1:1000001:1] ICMP flood [**] [Classification: Generic ICMP event] [Priority: 3] {ICMP} 192.168.178.81 -> 192.168.178.75
^C*** Caught Int-Signal
===============================================================================
Run time for packet processing was 352.89360 seconds
Snort processed 2897481 packets.
Snort ran for 0 days 0 hours 5 minutes 52 seconds
   Pkts/min:       579496
   Pkts/sec:         8231
===============================================================================
Memory usage summary:
  Total non-mmapped bytes (arena):       5685248
  Bytes in mapped regions (hblkhd):      16240640
  Total allocated space (uordblks):      3576408
  Total free space (fordblks):           2108840
  Topmost releasable block (keepcost):   119208
===============================================================================
Packet I/O Totals:
   Received:     19033615
   Analyzed:      2897481 ( 15.223%)
    Dropped:     16136076 ( 45.881%)
   Filtered:            0 (  0.000%)
Outstanding:     16136134 ( 84.777%)
   Injected:            0
===============================================================================
Breakdown by protocol (includes rebuilt packets):
        Eth:      2897486 (100.000%)
       VLAN:            0 (  0.000%)
        IP4:      2896379 ( 99.962%)
       Frag:            0 (  0.000%)
       ICMP:      2691664 ( 92.897%)
        UDP:          414 (  0.014%)
        TCP:       204254 (  7.049%)
        IP6:          604 (  0.021%)
    IP6 Ext:          669 (  0.023%)
   IP6 Opts:           65 (  0.002%)
      Frag6:            0 (  0.000%)
      ICMP6:          388 (  0.013%)
       UDP6:          216 (  0.007%)
       TCP6:            0 (  0.000%)
     Teredo:            0 (  0.000%)
    ICMP-IP:            0 (  0.000%)
    IP4/IP4:            0 (  0.000%)
    IP4/IP6:            0 (  0.000%)
    IP6/IP4:            0 (  0.000%)
    IP6/IP6:            0 (  0.000%)
        GRE:            0 (  0.000%)
    GRE Eth:            0 (  0.000%)
   GRE VLAN:            0 (  0.000%)
    GRE IP4:            0 (  0.000%)
    GRE IP6:            0 (  0.000%)
GRE IP6 Ext:            0 (  0.000%)
   GRE PPTP:            0 (  0.000%)
    GRE ARP:            0 (  0.000%)
    GRE IPX:            0 (  0.000%)
   GRE Loop:            0 (  0.000%)
       MPLS:            0 (  0.000%)
        ARP:           14 (  0.000%)
        IPX:            0 (  0.000%)
   Eth Loop:            0 (  0.000%)
   Eth Disc:            0 (  0.000%)
   IP4 Disc:            0 (  0.000%)
   IP6 Disc:            0 (  0.000%)
   TCP Disc:            0 (  0.000%)
   UDP Disc:            0 (  0.000%)
  ICMP Disc:            0 (  0.000%)
All Discard:            0 (  0.000%)
      Other:          536 (  0.018%)
Bad Chk Sum:       203643 (  7.028%)
    Bad TTL:            0 (  0.000%)
     S5 G 1:            1 (  0.000%)
     S5 G 2:            4 (  0.000%)
      Total:      2897486
===============================================================================
Action Stats:
     Alerts:      2686664 ( 92.724%)
     Logged:      2686664 ( 92.724%)
     Passed:            0 (  0.000%)
Limits:
      Match:            0
      Queue:            0
        Log:            0
      Event:          498
      Alert:            0
Verdicts:
      Allow:      2897481 ( 15.223%)
      Block:            0 (  0.000%)
    Replace:            0 (  0.000%)
  AllowFlow:            0 (  0.000%)
  BlockFlow:            0 (  0.000%)
     Ignore:            0 (  0.000%)
      Retry:            0 (  0.000%)
===============================================================================
Frag3 statistics:
        Total Fragments: 0
      Frags Reassembled: 0
               Discards: 0
          Memory Faults: 0
               Timeouts: 0
               Overlaps: 0
              Anomalies: 0
                 Alerts: 0
                  Drops: 0
     FragTrackers Added: 0
    FragTrackers Dumped: 0
FragTrackers Auto Freed: 0
    Frag Nodes Inserted: 0
     Frag Nodes Deleted: 0
===============================================================================
===============================================================================
Stream statistics:
            Total sessions: 203
              TCP sessions: 107
       Active TCP sessions: 0
  Non mempool TCP sess mem: 0
          TCP mempool used: 51785833707309568
              UDP sessions: 96
       Active UDP sessions: 96
          UDP mempool used: 51786555261815296
             ICMP sessions: 0
      Active ICMP sessions: 0
         ICMP mempool used: 51786572441684480
               IP sessions: 0
        Active IP sessions: 0
           IP mempool used: 51786589621553664
                TCP Prunes: 0
                UDP Prunes: 0
               ICMP Prunes: 0
                 IP Prunes: 0
TCP StreamTrackers Created: 107
TCP StreamTrackers Deleted: 107
              TCP Timeouts: 0
              TCP Overlaps: 0
       TCP Segments Queued: 89
     TCP Segments Released: 89
       TCP Rebuilt Packets: 0
         TCP Segments Used: 0
              TCP Discards: 64
                  TCP Gaps: 0
      UDP Sessions Created: 96
      UDP Sessions Deleted: 96
              UDP Timeouts: 0
              UDP Discards: 0
     ICMP Dest unreachable: 0
 ICMP Fragmentation needed: 0
                    Events: 103
           Internal Events: 0
           TCP Port Filter
                  Filtered: 0
                 Inspected: 0
                   Tracked: 606
           UDP Port Filter
                  Filtered: 0
                 Inspected: 0
                   Tracked: 96
===============================================================================
===============================================================================
FTPTelnet Preprocessor Statistics
  Current active FTP sessions                   : 0
  Max concurrent FTP sessions                   : 0
  Total FTP Data sessions                       : 0
  Max concurrent FTP Data sessions              : 0
  Current active Telnet sessions                : 0
  Max concurrent Telnet sessions                : 0
  Current ftp_telnet session non-mempool memory : 0
===============================================================================
SMTP Preprocessor Statistics
  Total sessions                                    : 0
  Max concurrent sessions                           : 0
===============================================================================
dcerpc2 Preprocessor Statistics
  Total sessions: 0
 Active sessions: 0

  Memory stats (bytes)
    Current total: 52428800
    Maximum total: 52515564
    Current runtime total: 52428800
    Maximum runtime total: 52428800
    Current config total: 0
    Maximum config total: 82292
    Current rule options total: 0
    Maximum rule options total: 0
    Current routing table total: 0
    Maximum routing table total: 0
    Current initialization total: 0
    Maximum initialization total: 4512
===============================================================================
===============================================================================
SIP Preprocessor Statistics
  Total sessions: 0
===============================================================================
IMAP Preprocessor Statistics
  Total sessions                                    : 0
  Max concurrent sessions                           : 0
===============================================================================
POP Preprocessor Statistics
  Total sessions                                    : 0
  Max concurrent sessions                           : 0
===============================================================================

Memory Statistics of DNS at: Mon May 15 18:24:44 2023


Heap Statistics of dns:
          Total Statistics:
               Memory in use:              0 bytes
                No of allocs:              1
                 No of frees:              1
         Config Statistics:
               Memory in use:              0 bytes
                No of allocs:              1
                 No of frees:              1
===============================================================================

Memory Statistics of Frag3 on: Mon May 15 18:24:44 2023

    Memory in use         : 0
    prealloc nodes in use : 0


Heap Statistics of frag:
          Total Statistics:
               Memory in use:              0 bytes
                No of allocs:              3
                 No of frees:              3
         Config Statistics:
               Memory in use:              0 bytes
                No of allocs:              3
                 No of frees:              3
===============================================================================

Memory Statistics of FTPTelnet at: Mon May 15 18:24:44 2023

       Current active FTP sessions :    0
       Max concurrent FTP sessions :    0
           Total FTP Data sessions :    0
  Max concurrent FTP Data sessions :    0
    Current active Telnet sessions :    0
    Max concurrent Telnet sessions :    0

Heap Statistics of ftptelnet:
          Total Statistics:
               Memory in use:              0 bytes
                No of allocs:            622
                 No of frees:            622
         Config Statistics:
               Memory in use:              0 bytes
                No of allocs:            622
                 No of frees:            622
===============================================================================
 Memory Statistics of Http Inspect on: Mon May 15 18:24:44 2023

     Current active session          : 0
    No of POST methods encountered  : 0
    No of GET methods encountered   : 0
    No of successfully extract post params      : 0
    No of successfully extract request params   : 0
    No of successfully extract response params  : 0
 Http Memory Pool       :
      Free Memory:                 0 bytes
      Used Memory:                 0 bytes
      Max Memory :                 0 bytes
 Mime Decode Memory Pool   :
      Free Memory:                 0 bytes
      Used Memory:                 0 bytes
      Max Memory :                 0 bytes
 Http Gzip Memory Pool     :
      Free Memory:                 0 bytes
      Used Memory:                 0 bytes
      Max Memory :                 0 bytes
 Http Mime log Memory Pool :
      Free Memory:                 0 bytes
      Used Memory:                 0 bytes
      Max Memory :                 0 bytes

Heap Statistics of httpinspect:
          Total Statistics:
               Memory in use:              0 bytes
                No of allocs:              5
                 No of frees:              5
        Session Statistics:
               Memory in use:              0 bytes
                No of allocs:              1
                 No of frees:              1
         Config Statistics:
               Memory in use:              0 bytes
                No of allocs:              3
                 No of frees:              3
        Mempool Statistics:
               Memory in use:              0 bytes
                No of allocs:              1
                 No of frees:              1
===============================================================================
SMTP Preprocessor Statistics
  Total sessions                : 277448
  Max concurrent sessions       : 277448
  Current sessions              : 277448
  SMTP Session
     Used Memory  :             0
     No of Allocs :             0
     No of Frees  :             0
  SMTP Config
     Used Memory  :          9356
     No of Allocs :            19
     No of Frees  :            71
   Total memory used :          9356

Heap Statistics of smtp:
          Total Statistics:
               Memory in use:           9356 bytes
                No of allocs:             19
                 No of frees:             71
         Config Statistics:
               Memory in use:           9356 bytes
                No of allocs:             19
                 No of frees:             71
===============================================================================

Memory Statistics of Stream on: Mon May 15 18:24:44 2023

Stream Session Statistics:
            Total sessions: 203
              TCP sessions: 107
       Active TCP sessions: 0
              UDP sessions: 96
       Active UDP sessions: 96
             ICMP sessions: 0
      Active ICMP sessions: 0
               IP sessions: 0
        Active IP sessions: 0
   TCP Memory Pool:
        Free Memory:                     0 bytes
        Used Memory:                     0 bytes
        Max Memory :                     0 bytes
   UDP Memory Pool:
        Free Memory:                     0 bytes
        Used Memory:                     0 bytes
        Max Memory :                     0 bytes
   ICMP Memory Pool:
        Free Memory:                     0 bytes
        Used Memory:                     0 bytes
        Max Memory :                     0 bytes
   IP Memory Pool:
        Free Memory:                     0 bytes
        Used Memory:                     0 bytes
        Max Memory :                     0 bytes
   Session Flow Memory Pool:
        Free Memory:                     0 bytes
        Used Memory:                     0 bytes
        Max Memory :                     0 bytes

Heap Statistics of stream:
          Total Statistics:
               Memory in use:        2072868 bytes
                No of allocs:            103
                 No of frees:             99
        Session Statistics:
               Memory in use:              0 bytes
                No of allocs:             90
                 No of frees:             90
         Config Statistics:
               Memory in use:        2072868 bytes
                No of allocs:             13
                 No of frees:              9
===============================================================================

Memory Statistics of DCE at: Mon May 15 18:24:44 2023

dcerpc2 Preprocessor Statistics:
                Total sessions :    0
               Active sessions :    0
            Total SMB sessions :    0
            Total TCP sessions :    0
            Total UDP sessions :    0
    Total HTTP server sessions :    0
     Total HTTP proxy sessions :    0
Total Memory stats :
                 Current total :    52428800
                 Maximum total :    52515564
                  Total memcap :    0
                    Free total :    0
SMB Memory stats :
                 Current total :    52428800
                 Maximum total :    52428800
          Current session data :    52428800
          Maximum session data :    52428800
   Current segmentation buffer :    0
   Maximum segmentation buffer :    0
TCP Memory stats :
                 Current total :    0
                 Maximum total :    0
          Current session data :    0
          Maximum session data :    0
UDP Memory stats :
                 Current total :    0
                 Maximum total :    0
          Current session data :    0
          Maximum session data :    0
HTTP Memory stats :
                 Current total :    0
                 Maximum total :    0
          Current session data :    0
          Maximum session data :    0

Heap Statistics of dce:
          Total Statistics:
               Memory in use:              0 bytes
                No of allocs:            115
                 No of frees:            115
         Config Statistics:
               Memory in use:              0 bytes
                No of allocs:            115
                 No of frees:            115
===============================================================================

Memory Statistics of SIP on: Mon May 15 18:24:44 2023

    Total Sessions          : 277448
    Current Active Sessions : 0


Heap Statistics of sip:
          Total Statistics:
               Memory in use:              0 bytes
                No of allocs:             22
                 No of frees:             22
         Config Statistics:
               Memory in use:              0 bytes
                No of allocs:             22
                 No of frees:             22
===============================================================================
POP Preprocessor Statistics
  Total sessions                : 277448
  Max concurrent sessions       : 277448
  Current sessions              : 277448
  POP Session
     Used Memory  :             0
     No of Allocs :             0
     No of Frees  :             0
  POP Config
     Used Memory  :           277
     No of Allocs :             3
     No of Frees  :            18
   Total memory used :           277

Heap Statistics of pop:
          Total Statistics:
               Memory in use:            277 bytes
                No of allocs:              3
                 No of frees:             18
         Config Statistics:
               Memory in use:            277 bytes
                No of allocs:              3
                 No of frees:             18
===============================================================================
IMAP Preprocessor Statistics
  Total sessions                : 277448
  Max concurrent sessions       : 277448
  Current sessions              : 277448
  IMAP Session
     Used Memory  :             0
     No of Allocs :             0
     No of Frees  :             0
  IMAP Config
     Used Memory  :           847
     No of Allocs :             3
     No of Frees  :            48
   Total memory used :           847

Heap Statistics of imap:
          Total Statistics:
               Memory in use:            847 bytes
                No of allocs:              3
                 No of frees:             48
         Config Statistics:
               Memory in use:            847 bytes
                No of allocs:              3
                 No of frees:             48
===============================================================================

Memory Statistics for File at:Mon May 15 18:24:44 2023

Total buffers allocated:           0
Total buffers freed:               0
Total buffers released:            0
Total file mempool:                0
Total allocated file mempool:      0
Total freed file mempool:          0
Total released file mempool:       0

Heap Statistics of file:
          Total Statistics:
               Memory in use:            140 bytes
                No of allocs:              6
                 No of frees:              1
        Session Statistics:
               Memory in use:              0 bytes
                No of allocs:              1
                 No of frees:              1
        Mempool Statistics:
               Memory in use:            140 bytes
                No of allocs:              5
                 No of frees:              0
===============================================================================
+-----------------------[filtered events]--------------------------------------
| gen-id=1      sig-id=40000056   type=Threshold tracking=src count=100 seconds=10  filtered=498
Snort exiting




attacker:

 sudo ./datetime.sh sudo hping3 --icmp --flood 192.168.178.81
[sudo] password for kali:
Timestamp START: 05/15-18:19:09.127030579
HPING 192.168.178.81 (eth0 192.168.178.81): icmp mode set, 28 headers + 0 data bytes
hping in flood mode, no replies will be shown
^C
--- 192.168.178.81 hping statistic ---
10128751 packets transmitted, 0 packets received, 100% packet loss
round-trip min/avg/max = 0.0/0.0/0.0 ms
Timestamp END: 05/15-18:24:20.736741747

